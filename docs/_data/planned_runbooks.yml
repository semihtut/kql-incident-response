# Planned runbooks - entries are auto-superseded when a .md file with the same ID exists
- id: RB-0005
  title: "MFA Fatigue Attack"
  severity: high
  tier: 1
  category: identity
  description: >
    Detects MFA push notification bombing attacks where adversaries repeatedly
    trigger MFA prompts hoping the user approves.
  tactics:
    - "Initial Access"
    - "Credential Access"

- id: RB-0006
  title: "Password Spray Detection"
  severity: high
  tier: 1
  category: identity
  description: >
    Detects distributed password spray attacks across multiple accounts using
    Identity Protection and SigninLogs analysis.
  tactics:
    - "Credential Access"
    - "Lateral Movement"

- id: RB-0007
  title: "Mass Secret Retrieval from Key Vault"
  severity: critical
  tier: 3
  category: azure-infrastructure
  description: >
    Detects mass enumeration and retrieval of secrets from Azure Key Vault,
    a common post-compromise activity for credential harvesting.
  tactics:
    - "Credential Access"
    - "Collection"
    - "Exfiltration"

- id: RB-0008
  title: "Suspicious Inbox Forwarding Rule"
  severity: high
  tier: 2
  category: email
  description: >
    Detects suspicious inbox forwarding or redirect rules in Exchange Online
    that may indicate BEC or data exfiltration via email collection.
  tactics:
    - "Collection"
    - "Exfiltration"
    - "Persistence"
    - "Defense Evasion"

- id: RB-0009
  title: "Atypical Travel"
  severity: medium
  tier: 1
  category: identity
  description: >
    Detects sign-ins from locations that deviate from the user's ML-learned
    geographic behavior pattern, including first-time countries and
    Cloud Apps impossible travel correlation.
  tactics:
    - "Initial Access"
    - "Defense Evasion"
    - "Credential Access"

- id: RB-0010
  title: "Suspicious Service Principal Activity"
  severity: high
  tier: 2
  category: identity
  description: >
    Detects compromised or abused service principals (app registrations) via
    credential theft, unauthorized credential additions, anomalous sign-in
    patterns, and excessive resource access.
  tactics:
    - "Persistence"
    - "Privilege Escalation"
    - "Credential Access"
    - "Defense Evasion"
    - "Lateral Movement"

- id: RB-0011
  title: "Consent Grant Attack"
  severity: high
  tier: 2
  category: identity
  description: >
    Detects illicit OAuth application consent grant attacks where users are
    tricked into authorizing rogue applications with access to their email,
    files, and directory data via delegated permissions.
  tactics:
    - "Initial Access"
    - "Persistence"
    - "Credential Access"
    - "Collection"
    - "Exfiltration"

- id: RB-0012
  title: "Suspicious MFA Method Registration"
  severity: high
  tier: 2
  category: identity
  description: >
    Detects suspicious MFA authentication method registrations on compromised
    accounts where attackers register their own MFA method to maintain persistent
    access that survives password resets.
  tactics:
    - "Persistence"
    - "Privilege Escalation"
    - "Defense Evasion"
    - "Credential Access"

- id: RB-0013
  title: "Privileged Role Assignment Anomaly"
  severity: critical
  tier: 2
  category: identity
  description: >
    Detects anomalous privileged directory role assignments in Entra ID and PIM,
    including unauthorized Global Administrator grants, permanent assignments
    bypassing PIM, and post-escalation tenant configuration changes.
  tactics:
    - "Persistence"
    - "Privilege Escalation"
    - "Defense Evasion"
    - "Discovery"

- id: RB-0014
  title: "AiTM Phishing / Anomalous Token Detection"
  severity: critical
  tier: 2
  category: identity
  description: >
    Detects Adversary-in-the-Middle phishing attacks and stolen session token
    replay. Covers anomalous token risk events, session IP divergence, token
    replay patterns, BEC activity chain, and multi-persistence detection.
  tactics:
    - "Initial Access"
    - "Credential Access"
    - "Defense Evasion"
    - "Collection"
    - "Exfiltration"

- id: RB-0015
  title: "Conditional Access Policy Manipulation"
  severity: critical
  tier: 2
  category: identity
  description: >
    Detects unauthorized modifications to Conditional Access policies that
    weaken security posture, including policy disablement, exclusion additions,
    trusted location manipulation, and MFA requirement removal.
  tactics:
    - "Defense Evasion"
    - "Persistence"
    - "Privilege Escalation"
    - "Credential Access"

- id: RB-0016
  title: "Smart Lockout Triggered"
  severity: high
  tier: 2
  category: identity
  description: >
    Detects Azure AD Smart Lockout events indicating active brute force or
    credential stuffing attacks. Covers lockout trigger analysis, attack source
    infrastructure profiling, post-lockout success detection, and coordinated
    multi-account campaign identification.
  tactics:
    - "Credential Access"
    - "Initial Access"
    - "Defense Evasion"

- id: RB-0017
  title: "High-Risk ISP/Hosting Provider Sign-Ins"
  severity: high
  tier: 2
  category: identity
  description: >
    Detects sign-ins from VPS providers, cloud hosting platforms, Tor exit
    nodes, and residential proxy networks. Covers ASN-based infrastructure
    classification, post-authentication activity audit, and org-wide hosting
    infrastructure sign-in sweep.
  tactics:
    - "Initial Access"
    - "Defense Evasion"
    - "Credential Access"
    - "Command and Control"

- id: RB-0018
  title: "Self-Service Password Reset Abuse"
  severity: high
  tier: 2
  category: identity
  description: >
    Detects abuse of Self-Service Password Reset (SSPR) from atypical
    locations or devices, password resets followed by immediate MFA changes
    or suspicious activity, and organization-wide anomalous reset patterns.
  tactics:
    - "Credential Access"
    - "Persistence"
    - "Initial Access"
    - "Defense Evasion"

- id: RB-0019
  title: "Inactive Account Reactivation"
  severity: medium
  tier: 2
  category: identity
  description: >
    Detects dormant or inactive accounts that suddenly become active after
    extended periods of inactivity. Covers dormancy period analysis,
    reactivation context, post-reactivation activity audit, and org-wide
    stale account abuse sweep.
  tactics:
    - "Initial Access"
    - "Persistence"
    - "Defense Evasion"
    - "Credential Access"
